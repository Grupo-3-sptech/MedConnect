<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="shortcut icon" href="../assets/icon/favicon2.ico" type="image/x-icon">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MedConnect | Cadastrar Cirurgia</title>

    <link rel="stylesheet" href="css/dashboard.css">
    <!-- <script src="../js/sessao.js"></script>
    <script src="./../js/alerta.js"></script> -->

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link
        href="https://fonts.googleapis.com/css2?family=Exo+2:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">

    <!-- scripts do Chart.js - 2022-1 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!--FONT AWESOME-->
    <script src="https://kit.fontawesome.com/9f7414eb10.js" crossorigin="anonymous"></script>
</head>

<!-- <body onload=" atualizarFeed()"> -->

<body>

    <!-- <div class="janela">
        <div class="header-left">
        
             <div class="hello">
                <h3>Olá, <span id="b_usuario">usuário</span>!</h3>
            </div>
    
            <div class="btn-nav">

                <div id="grafico1">
                </div>
                <div id="grafico2">
                </div>
                <div id="grafico3">
                </div>
            </div>

            <button class="btn-logout" onclick="voltarHome()">
                <h3>Sair</h3>
            </button>

        </div>

        <div class="dash">
            <div id="alerta">
            </div>

            <div class="btns-dash" id="btnAquario">
            </div>
        </div>
    </div> -->

    <div class="principal">
        <div class="sidebar">
            <div class="content-sidebar">
                <div class="logo-sidebar">
                    <img src="../Img/logo horizontal sem fundo.png" alt="">
                </div>

                <div class="options-sidebar">
                    <div class="opt">
                        <img src="../Img/icons8-gráfico-combinado-30.png" alt="">
                        <a href="dashboard.html">Dashboard Geral</a>
                    </div>

                    <div class="opt">
                        <img src="../Img/icons8-robô-48.png" alt="">
                        <a href="dash-robo.html">Dashboard Rôbos</a>
                    </div>

                    <div class="opt" id="gerenciar-usuarios">
                        <img src="../Img/icons8-usuário-30.png" id="diminuir" alt="">
                        <a href="dash-gerenciar-users.html">Gerenciar Usuários</a>
                    </div>

                    <div class="opt">
                        <img src="../Img/icons8-usuário-30.png" id="diminuir" alt="">
                        <a href="perfil.html">Perfil</a>
                    </div>

                    <div class="opt" id="aqui">
                        <img src="Img/icons8-hospital-50.png" id="diminuir" alt="">
                        <a href="cadastrar-cirurgia.html">Gerenciar Cirurgia</a>
                    </div>

                    <div class="opt">
                        <img src="../Img/icons8-assistente-48.png" alt="">
                        <a href="dash-suporte.html">Suporte</a>
                    </div>

                    <div class="opt">
                        <img src="../Img/icons8-alerta-30.png" alt="">
                        <a href="#">Chamado</a>
                    </div>
                </div>

                <div class="quit-button">
                    <div class="opt">
                        <img src="../Img/icons8-sair-30.png" alt="">
                        <a href="index.html">Log Out</a>
                    </div>
                </div>
            </div>
        </div>

        <div class="content" style="height: fit-content;">
            <div class="header-content">
                <div class="navbar-header" style="height: 10vh;">
                    <h3>Gerenciar Cirurgias</h3>
                    <p>Olá, <span style="font-weight: bolder;" id="b_usuario"></span></p>
                </div>
            </div>

            <div class="container-cirurgia" style="height: fit-content;">

                <div class="content-listagem">
                    <div class="listagem">
                        <h3 style="margin-top: 3%;">Cirurgias Recentes</h3>
    
                        <div class="cirurgia">
                            <div class="item-cirurgia">
                                <b>Médico</b>
                                <span id="nome_medico">Gabriel Boos</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Data Início</b>
                                <span id="data_inicio">24/01/2000</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Horário Início</b>
                                <span id="horario_inicio">21:00:02</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Duração Min.</b>
                                <span id="duracao_minutos">123m</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Paciente</b>
                                <span id="nome_paciente">Bianca Reis</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Sala</b>
                                <span id="sala_cirurgia">3</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Categoria</b>
                                <span id="categoria_cirurgia">Neurologia</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Risco</b>
                                <span id="risco_cirurgia">5</span>
                            </div>
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lápis-20.png" alt="">
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lixo-20.png" alt="">
                        </div>
    
    
                        <div class="cirurgia">
                            <div class="item-cirurgia">
                                <b>Médico</b>
                                <span id="nome_medico">Gabriel Boos</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Data Início</b>
                                <span id="data_inicio">24/01/2000</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Horário Início</b>
                                <span id="horario_inicio">21:00:02</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Duração Min.</b>
                                <span id="duracao_minutos">123m</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Paciente</b>
                                <span id="nome_paciente">Bianca Reis</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Sala</b>
                                <span id="sala_cirurgia">3</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Categoria</b>
                                <span id="categoria_cirurgia">Neurologia</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Risco</b>
                                <span id="risco_cirurgia">5</span>
                            </div>
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lápis-20.png" alt="">
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lixo-20.png" alt="">
                        </div>
    
                        <div class="cirurgia">
                            <div class="item-cirurgia">
                                <b>Médico</b>
                                <span id="nome_medico">Gabriel Boos</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Data Início</b>
                                <span id="data_inicio">24/01/2000</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Horário Início</b>
                                <span id="horario_inicio">21:00:02</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Duração Min.</b>
                                <span id="duracao_minutos">123m</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Paciente</b>
                                <span id="nome_paciente">Bianca Reis</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Sala</b>
                                <span id="sala_cirurgia">3</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Categoria</b>
                                <span id="categoria_cirurgia">Neurologia</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Risco</b>
                                <span id="risco_cirurgia">5</span>
                            </div>
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lápis-20.png" alt="">
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lixo-20.png" alt="">
                        </div>
    
                        <div class="cirurgia">
                            <div class="item-cirurgia">
                                <b>Médico</b>
                                <span id="nome_medico">Gabriel Boos</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Data Início</b>
                                <span id="data_inicio">24/01/2000</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Horário Início</b>
                                <span id="horario_inicio">21:00:02</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Duração Min.</b>
                                <span id="duracao_minutos">123m</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Paciente</b>
                                <span id="nome_paciente">Bianca Reis</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Sala</b>
                                <span id="sala_cirurgia">3</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Categoria</b>
                                <span id="categoria_cirurgia">Neurologia</span>
                            </div>
                            <div class="item-cirurgia">
                                <b>Risco</b>
                                <span id="risco_cirurgia">5</span>
                            </div>
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lápis-20.png" alt="">
                            <img style="height: 4vh; width: auto;" src="./Img/icons8-lixo-20.png" alt="">
                        </div>
                    </div>
                </div>


                <div class="drop-cadastrar">
                    <h3>
                        Cadastrar Cirurgia 
                        <img src="./Img/icons8-divisa-circulada-à-direita-24.png" alt="" onclick="dropCadastro()">
                    </h3>
                    <div style="display: none;" class="form-cirurgia" id="form_cirurgia">
                        <div class="content-form-cirurgia">
                            <div class="div1">
                                <div class="input-cirurgia">
                                    Nome do médico
                                    <input type="text">
                                </div>
                                <div class="input-cirurgia">
                                    Data de início
                                    <input type="date">
                                </div>  
                                <div class="input-cirurgia">
                                    Horário de início
                                    <input type="time">
                                </div>  
                                <div class="input-cirurgia">
                                    Duração esperada em minutos
                                    <input type="number">
                                </div>  
                                
                            </div>
                            <div class="div1">
                                <div class="input-cirurgia">
                                    Nome do paciente
                                    <input type="text">
                                </div>
                                <div class="input-cirurgia">
                                    Sala de cirurgia
                                    <select name="" id=""></select>
                                </div>
                                <div class="input-cirurgia">
                                    Categoria Cirúrgica
                                    <select name="" id="" >
                                        <option value="Cardiologia">Cardiologia</option>
                                        <option value="Cardiologia">Neurologia</option>
                                        <option value="Cardiologia">Ortopedia</option>
                                        <option value="Cardiologia">Ginecologia</option>
                                        <option value="Cardiologia">Geral</option>
                                        <option value="Cardiologia">Epigástrica</option>
                                        <option value="Cardiologia">Oftalmologia</option>
                                        <option value="Cardiologia">Otorrinolaringologia</option>
                                        <option value="Cardiologia">Pediátrica</option>
                                        <option value="Cardiologia">Plástica</option>
                                        <option value="Cardiologia">Proctologia</option>
                                        <option value="Cardiologia">Vascular</option>
                                        <option value="Cardiologia">Urologia</option>
                                    </select>
                                    
                                </div>
                                <div class="input-cirurgia">
                                    Risco Cirúrgico
                                    <input type="range" min="1" max="5">
                                </div>  
                            </div>
                            <div class="div1">
                                <button style="background-color: rgb(50, 125, 50);">Cadastrar</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="drop-cadastrar" style="margin-top: 2%; margin-bottom: 2%;">
                    <h3>
                        Editar Cirurgia 
                        <img src="./Img/icons8-divisa-circulada-à-direita-24.png" alt="" onclick="dropEditar()">
                    </h3>
                    <div style="display: none;" class="form-cirurgia" id="form_cirurgia2">
                        <div class="content-form-cirurgia">
                            <div class="div1">
                                <div class="input-cirurgia">
                                    Nome do médico
                                    <input type="text">
                                </div>
                                <div class="input-cirurgia">
                                    Data de início
                                    <input type="date">
                                </div>  
                                <div class="input-cirurgia">
                                    Horário de início
                                    <input type="time">
                                </div>  
                                <div class="input-cirurgia">
                                    Duração esperada em minutos
                                    <input type="number">
                                </div>  
                                
                            </div>
                            <div class="div1">
                                <div class="input-cirurgia">
                                    Nome do paciente
                                    <input type="text">
                                </div>
                                <div class="input-cirurgia">
                                    Sala de cirurgia
                                    <select name="" id=""></select>
                                </div>
                                <div class="input-cirurgia">
                                    Categoria Cirúrgica
                                    <select name="" id="" >
                                        <option value="Cardiologia">Cardiologia</option>
                                        <option value="Cardiologia">Neurologia</option>
                                        <option value="Cardiologia">Ortopedia</option>
                                        <option value="Cardiologia">Ginecologia</option>
                                        <option value="Cardiologia">Geral</option>
                                        <option value="Cardiologia">Epigástrica</option>
                                        <option value="Cardiologia">Oftalmologia</option>
                                        <option value="Cardiologia">Otorrinolaringologia</option>
                                        <option value="Cardiologia">Pediátrica</option>
                                        <option value="Cardiologia">Plástica</option>
                                        <option value="Cardiologia">Proctologia</option>
                                        <option value="Cardiologia">Vascular</option>
                                        <option value="Cardiologia">Urologia</option>
                                    </select>
                                    
                                </div>
                                <div class="input-cirurgia">
                                    Risco Cirúrgico
                                    <input type="range" min="1" max="5">
                                </div>  
                            </div>
                            <div class="div1">
                                <button style="background-color: rgb(193, 95, 46);">Editar</button>
                            </div>
                        </div>
                    </div>
                </div>
                
            </div>
            
        </div>
    </div>




</body>

</html>

<script>

    var drop = 0
    function dropCadastro(){
        if(drop == 0){
            form_cirurgia.style.display = "flex"
            drop = 1
        } else{
            form_cirurgia.style.display = "none"
            drop = 0
        }
       
    }
    
    var drop2 = 0
    function dropEditar(){
        if(drop2 == 0){
            form_cirurgia2.style.display = "flex"
            drop2 = 1
        } else{
            form_cirurgia2.style.display = "none"
            drop2 = 0
        }
       
    }


    cargo = sessionStorage.CARGO_USUARIO

    gerenciarUsuarios = document.getElementById("gerenciar-usuarios")
    console.log(gerenciarUsuarios)

    // if (cargo !== "Atendente") {
    //     window.location = "dashboard.html"
    // }

    if (cargo !== "Admin") {
        gerenciarUsuarios.style = 'display: none'
    }

    function voltarHome() {
        window.location = '../index.html'
    }

    b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

    var id = 1

    // window.onload = exibirComponentes(id);

    var cargos;
    fetch("/cargo/listar", {
        method: "GET",
        headers: {
            "Content-Type": "application/json"
        }
    })
        .then(response => {
            if (!response.ok) {
                throw new Error('Erro ao fazer a solicitação GET');
            }
            return response.json();
        }).then(data => {

            console.log(data)

            cargos = data;

            var selectElement = document.getElementById('cargoSelect');

            // Itera sobre o array de empresas e cria as opções do select
            for (let i = 0; i < cargos.length; i++) {
                const cargo = cargos[i];

                const optionElement = document.createElement('option');
                optionElement.value = cargo.idEscalonamento;
                optionElement.text = cargo.cargo;
                selectElement.appendChild(optionElement);
            }

        }).catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
        });


    var funcionarios;
    var idHospital = sessionStorage.ID_HOSPITAL

    fetch(`/funcionarioAssociado/verificar/${idHospital}`)
        .then(function (resposta) {
            console.log("ESTOU NO THEN DO entrar()!")

            if (resposta.ok) {
                console.log(resposta);

                resposta.json().then(json => {
                    console.log(json);
                    console.log(JSON.stringify(json));

                    funcionarios = json

                    tabela = document.getElementById("tabela-funcionario")

                    // Itera sobre o array de empresas e cria as opções do select
                    for (let i = 0; i < funcionarios.length; i++) {
                        const funcionario = funcionarios[i];
                        const email = funcionario.email;
                        const cargo = funcionario.cargo;
                        const idAssociado = funcionario.idAssociado;

                        var novaLinha = tabela.insertRow();
                        novaLinha.id = idAssociado // Insere uma nova linha
                        var celula1 = novaLinha.insertCell(0); // Insere uma célula na posição 0
                        var celula2 = novaLinha.insertCell(1);
                        var celula3 = novaLinha.insertCell(2)
                        celula1.innerHTML = `${email}`;
                        celula2.innerHTML = `${cargo}`;
                        celula3.innerHTML = `<img src="Img/excluir.png" onclick="remover(${idAssociado})" alt="Excluir">`
                    }
                });

            }
        }).catch(function (erro) {
            console.log(erro);
            Swal.fire('É PRECISO LOGAR PARA CADASTRAR UM EMAIL')
        })

    function salvar() {
        var email = input_email.value;
        var cargo = cargoSelect.value

        if (email == "" || cargo == "") {

        }
        else {
            fetch("/funcionarioAssociado/cadastrar", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    emailServer: email,
                    idHospitalServer: idHospital,
                    idEscalonamentoServer: cargo
                })
            }).then(function (resposta) {
                console.log("ESTOU NO THEN DO entrar()!")

                if (resposta.ok) {
                    console.log(resposta);

                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json))

                        setTimeout(function () {
                            location.reload();
                        }, 1000); // 

                    })
                } else {

                }

            }).catch(function (erro) {
                console.log(erro);

            })
        }
    }

    function remover(idAssociado) {

        fetch(`/funcionarioAssociado/deletar`, {
            method: 'DELETE',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                idServer: idAssociado,
            })
        })
            .then(function (resposta) {
                console.log("ESTOU NO THEN DO entrar()!")

                if (resposta.ok) {
                    console.log(resposta);

                    resposta.json().then(json => {
                        console.log(json);
                        console.log(JSON.stringify(json));
                        setTimeout(function () {
                            location.reload();
                        }, 1000); // 
                        // funcionarios = json

                        // tabela = document.getElementById("tabela-funcionario")

                        // // Itera sobre o array de empresas e cria as opções do select
                        // for (let i = 0; i < funcionarios.length; i++) {
                        //     const funcionario = funcionarios[i];
                        //     const email = funcionario.email;
                        //     const cargo = funcionario.cargo;
                        //     const idAssociado = funcionario.idAssociado;

                        //     var novaLinha = tabela.insertRow();
                        //     novaLinha.id = idAssociado // Insere uma nova linha
                        //     var celula1 = novaLinha.insertCell(0); // Insere uma célula na posição 0
                        //     var celula2 = novaLinha.insertCell(1);
                        //     var celula3 = novaLinha.insertCell(2)
                        //     celula1.innerHTML = `${email}`;
                        //     celula2.innerHTML = `${cargo}`;
                        //     celula3.innerHTML = `<img src="Img/excluir.png" onclick="remover(idAssociado)" alt="Excluir">`
                        // }
                    });

                }
            }).catch(function (erro) {
                console.log(erro);
                Swal.fire('É PRECISO LOGAR PARA CADASTRAR UM EMAIL')
            })
    }


    // function ajustarTabela() {
    //   var tabela = document.getElementById("minhaTabela");
    //   var larguraTela = window.innerWidth;

    //   if (larguraTela < 600) {
    //     for (var i = 0; i < tabela.rows.length; i++) {
    //       tabela.rows[i].cells[2].style.display = "none";
    //     }
    //   } else {
    //     for (var i = 0; i < tabela.rows.length; i++) {
    //       tabela.rows[i].cells[2].style.display = "table-cell";
    //     }
    //   }
    // }

    // // Chama a função de ajuste da tabela quando a página carrega e quando a tela é redimensionada
    // window.addEventListener("load", ajustarTabela);
    // window.addEventListener("resize", ajustarTabela);

</script>